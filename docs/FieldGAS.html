<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nibia Becerra Santillan">
<meta name="dcterms.date" content="2025-04-29">
<meta name="description" content="Pipeline for field gas fluxes with tidyverse and QC checks.">

<title>Final Field Gas Data Processing – Nibia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c1fac2584b48ed01fb6e278e36375074.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Nibia</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./projects.html"> 
<span class="menu-text">Projects Overview</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-air-data-processing-and-visualizations" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Air Data Processing and Visualizations</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-air-data-processing-and-visualizations">    
        <li>
    <a class="dropdown-item" href="./LabGas.html">
 <span class="dropdown-text">Laboratory Gas Data Processing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./FieldGas.qmd">
 <span class="dropdown-text">Field Gas Data Processing</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-science-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Data Science Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-science-projects">    
        <li>
    <a class="dropdown-item" href="./DiD_ColombiaVenezuela.html">
 <span class="dropdown-text">Difference in Difference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./LDA_thematic_analysis/Report.html">
 <span class="dropdown-text">LDA thematic analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Clustering.html">
 <span class="dropdown-text">Clustering</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-stat-content-summary" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">STAT Content Summary</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-stat-content-summary">    
        <li>
    <a class="dropdown-item" href="./Content_Summary.html">
 <span class="dropdown-text">Intro to GWAS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ContentSummary2forreal.html">
 <span class="dropdown-text">PCA for GWAS</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:nibiab.work@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/nibia-becerra-santillan/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text">LinkedIn</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages">Load Packages</a></li>
  <li><a href="#run-the-data" id="toc-run-the-data" class="nav-link" data-scroll-target="#run-the-data">Run the data</a></li>
  <li><a href="#clean-the-data" id="toc-clean-the-data" class="nav-link" data-scroll-target="#clean-the-data">Clean the data</a></li>
  <li><a href="#making-the-means" id="toc-making-the-means" class="nav-link" data-scroll-target="#making-the-means">Making the means</a>
  <ul class="collapse">
  <li><a href="#graph-just-for-data-exploration" id="toc-graph-just-for-data-exploration" class="nav-link" data-scroll-target="#graph-just-for-data-exploration">Graph just for data exploration</a></li>
  </ul></li>
  <li><a href="#co2-two-way-anova" id="toc-co2-two-way-anova" class="nav-link" data-scroll-target="#co2-two-way-anova">CO2 Two way ANOVA</a></li>
  <li><a href="#co2" id="toc-co2" class="nav-link" data-scroll-target="#co2">CO2</a>
  <ul class="collapse">
  <li><a href="#final-mixed-effects-model" id="toc-final-mixed-effects-model" class="nav-link" data-scroll-target="#final-mixed-effects-model">Final Mixed effects model</a></li>
  </ul></li>
  <li><a href="#interaction-terms-analysis" id="toc-interaction-terms-analysis" class="nav-link" data-scroll-target="#interaction-terms-analysis">Interaction terms analysis</a>
  <ul class="collapse">
  <li><a href="#is-p1-mean-co2-higher-than-p5" id="toc-is-p1-mean-co2-higher-than-p5" class="nav-link" data-scroll-target="#is-p1-mean-co2-higher-than-p5">Is P1 mean CO2 higher than P5?</a></li>
  </ul></li>
  <li><a href="#ch4" id="toc-ch4" class="nav-link" data-scroll-target="#ch4">CH4</a></li>
  <li><a href="#graph" id="toc-graph" class="nav-link" data-scroll-target="#graph">Graph</a></li>
  <li><a href="#final-mixed-effects-model-1" id="toc-final-mixed-effects-model-1" class="nav-link" data-scroll-target="#final-mixed-effects-model-1">Final Mixed effects model</a></li>
  <li><a href="#interaction-terms-analysis-1" id="toc-interaction-terms-analysis-1" class="nav-link" data-scroll-target="#interaction-terms-analysis-1">Interaction terms analysis</a></li>
  <li><a href="#change-in-co2-and-ch4-over-time-making-variables" id="toc-change-in-co2-and-ch4-over-time-making-variables" class="nav-link" data-scroll-target="#change-in-co2-and-ch4-over-time-making-variables">Change in CO2 and CH4 over time: Making variables</a></li>
  <li><a href="#change-in-co2-and-ch4-over-time-graphing" id="toc-change-in-co2-and-ch4-over-time-graphing" class="nav-link" data-scroll-target="#change-in-co2-and-ch4-over-time-graphing">Change in CO2 and CH4 over time: Graphing</a></li>
  <li><a href="#both-plots-together" id="toc-both-plots-together" class="nav-link" data-scroll-target="#both-plots-together">both plots together</a></li>
  <li><a href="#timeseries-per-date" id="toc-timeseries-per-date" class="nav-link" data-scroll-target="#timeseries-per-date">Timeseries per date</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Final Field Gas Data Processing</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
  </div>
  </div>

<div>
  <div class="description">
    Pipeline for field gas fluxes with tidyverse and QC checks.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nibia Becerra Santillan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 29, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load Packages</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="run-the-data" class="level2">
<h2 class="anchored" data-anchor-id="run-the-data">Run the data</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ALLfluxData <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'./AllDataNIBIASummer23.csv'</span>) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">file.exists</span>(<span class="st">'./AllDataNIBIASummer23.csv'</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>fluxData <span class="ot">&lt;-</span> ALLfluxData[<span class="dv">3</span><span class="sc">:</span><span class="dv">321</span>,]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fluxData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  `LI-8200...1`       `LI-8200...2` CHAMBER...3 `LI-7810...4` `LI-7810...5`
  &lt;chr&gt;               &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;        
1 2023/07/28 11:47:07 P5C1-5        26.842420   -0.028000     0.385390     
2 2023/07/28 11:50:22 P5C2-5        27.249850   0.016820      0.246480     
3 2023/07/28 11:53:31 P5C3-5        27.517150   -0.173680     0.975170     
4 2023/07/28 11:56:13 P5C4-5        27.654310   -0.608000     0.996050     
5 2023/07/28 11:59:15 P5E1-5        27.527430   -0.372980     0.991450     
6 2023/07/28 12:02:12 P5E2-5        27.516550   -0.155130     0.949200     
# ℹ 4 more variables: `LI-7810...6` &lt;chr&gt;, `LI-7810...7` &lt;chr&gt;,
#   CHAMBER...8 &lt;chr&gt;, CHAMBER...9 &lt;chr&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fluxData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [319 × 9] (S3: tbl_df/tbl/data.frame)
 $ LI-8200...1: chr [1:319] "2023/07/28 11:47:07" "2023/07/28 11:50:22" "2023/07/28 11:53:31" "2023/07/28 11:56:13" ...
 $ LI-8200...2: chr [1:319] "P5C1-5" "P5C2-5" "P5C3-5" "P5C4-5" ...
 $ CHAMBER...3: chr [1:319] "26.842420" "27.249850" "27.517150" "27.654310" ...
 $ LI-7810...4: chr [1:319] "-0.028000" "0.016820" "-0.173680" "-0.608000" ...
 $ LI-7810...5: chr [1:319] "0.385390" "0.246480" "0.975170" "0.996050" ...
 $ LI-7810...6: chr [1:319] "-0.136420" "0.582360" "2.530090" "4.022230" ...
 $ LI-7810...7: chr [1:319] "0.156910" "0.964540" "0.995570" "0.998730" ...
 $ CHAMBER...8: chr [1:319] "1.400000" "0.380000" "0.830000" "0.470000" ...
 $ CHAMBER...9: chr [1:319] "0.253980" "0.007730" "-9999.000000" "0.279600" ...</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fluxData) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DateTime"</span>, <span class="st">"LABEL"</span>, <span class="st">"Temp"</span>, <span class="st">"FCH4_DRY_LIN"</span>, <span class="st">"FCH4_DRY_LIN_R2"</span>, <span class="st">"FCO2_DRY_LIN"</span>, <span class="st">"FCO2_DRY_LIN_R2"</span>, <span class="st">"COLLAR_HEIGHT"</span>, <span class="st">"SoilMoist_mean"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fluxData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DateTime"        "LABEL"           "Temp"            "FCH4_DRY_LIN"   
[5] "FCH4_DRY_LIN_R2" "FCO2_DRY_LIN"    "FCO2_DRY_LIN_R2" "COLLAR_HEIGHT"  
[9] "SoilMoist_mean" </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fluxData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [319 × 9] (S3: tbl_df/tbl/data.frame)
 $ DateTime       : chr [1:319] "2023/07/28 11:47:07" "2023/07/28 11:50:22" "2023/07/28 11:53:31" "2023/07/28 11:56:13" ...
 $ LABEL          : chr [1:319] "P5C1-5" "P5C2-5" "P5C3-5" "P5C4-5" ...
 $ Temp           : chr [1:319] "26.842420" "27.249850" "27.517150" "27.654310" ...
 $ FCH4_DRY_LIN   : chr [1:319] "-0.028000" "0.016820" "-0.173680" "-0.608000" ...
 $ FCH4_DRY_LIN_R2: chr [1:319] "0.385390" "0.246480" "0.975170" "0.996050" ...
 $ FCO2_DRY_LIN   : chr [1:319] "-0.136420" "0.582360" "2.530090" "4.022230" ...
 $ FCO2_DRY_LIN_R2: chr [1:319] "0.156910" "0.964540" "0.995570" "0.998730" ...
 $ COLLAR_HEIGHT  : chr [1:319] "1.400000" "0.380000" "0.830000" "0.470000" ...
 $ SoilMoist_mean : chr [1:319] "0.253980" "0.007730" "-9999.000000" "0.279600" ...</code></pre>
</div>
</div>
</section>
<section id="clean-the-data" class="level2">
<h2 class="anchored" data-anchor-id="clean-the-data">Clean the data</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangling</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>Temp <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, fluxData<span class="sc">$</span>Temp)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>FCH4_DRY_LIN <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, fluxData<span class="sc">$</span>FCH4_DRY_LIN)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>FCH4_DRY_LIN_R2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, fluxData<span class="sc">$</span>FCH4_DRY_LIN_R2)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>FCO2_DRY_LIN <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, fluxData<span class="sc">$</span>FCO2_DRY_LIN)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>FCO2_DRY_LIN_R2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, fluxData<span class="sc">$</span>FCO2_DRY_LIN_R2)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>COLLAR_HEIGHT <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, fluxData<span class="sc">$</span>COLLAR_HEIGHT)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>SoilMoist_mean<span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, fluxData<span class="sc">$</span>SoilMoist_mean)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>Temp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(fluxData<span class="sc">$</span>Temp)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>FCH4_DRY_LIN <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(fluxData<span class="sc">$</span>FCH4_DRY_LIN)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>FCH4_DRY_LIN_R2<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(fluxData<span class="sc">$</span>FCH4_DRY_LIN_R2)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>FCO2_DRY_LIN <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(fluxData<span class="sc">$</span>FCO2_DRY_LIN)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>FCO2_DRY_LIN_R2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(fluxData<span class="sc">$</span>FCO2_DRY_LIN_R2)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>COLLAR_HEIGHT<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(fluxData<span class="sc">$</span>COLLAR_HEIGHT)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>SoilMoist_mean  <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(fluxData<span class="sc">$</span>SoilMoist_mean)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fluxData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [319 × 9] (S3: tbl_df/tbl/data.frame)
 $ DateTime       : chr [1:319] "2023/07/28 11:47:07" "2023/07/28 11:50:22" "2023/07/28 11:53:31" "2023/07/28 11:56:13" ...
 $ LABEL          : chr [1:319] "P5C1-5" "P5C2-5" "P5C3-5" "P5C4-5" ...
 $ Temp           : num [1:319] 26.8 27.2 27.5 27.7 27.5 ...
 $ FCH4_DRY_LIN   : num [1:319] -0.028 0.0168 -0.1737 -0.608 -0.373 ...
 $ FCH4_DRY_LIN_R2: num [1:319] 0.385 0.246 0.975 0.996 0.991 ...
 $ FCO2_DRY_LIN   : num [1:319] -0.136 0.582 2.53 4.022 3.104 ...
 $ FCO2_DRY_LIN_R2: num [1:319] 0.157 0.965 0.996 0.999 0.996 ...
 $ COLLAR_HEIGHT  : num [1:319] 1.4 0.38 0.83 0.47 0.3 0.75 0.27 1 0.87 1.27 ...
 $ SoilMoist_mean : num [1:319] 2.54e-01 7.73e-03 -1.00e+04 2.80e-01 -1.00e+04 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fluxData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  DateTime LABEL  Temp FCH4_DRY_LIN FCH4_DRY_LIN_R2 FCO2_DRY_LIN FCO2_DRY_LIN_R2
  &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;
1 2023/07… P5C1…  26.8      -0.028            0.385       -0.136           0.157
2 2023/07… P5C2…  27.2       0.0168           0.246        0.582           0.965
3 2023/07… P5C3…  27.5      -0.174            0.975        2.53            0.996
4 2023/07… P5C4…  27.7      -0.608            0.996        4.02            0.999
5 2023/07… P5E1…  27.5      -0.373            0.991        3.10            0.996
6 2023/07… P5E2…  27.5      -0.155            0.949        2.22            0.997
# ℹ 2 more variables: COLLAR_HEIGHT &lt;dbl&gt;, SoilMoist_mean &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>DateTime_chr <span class="ot">&lt;-</span> fluxData<span class="sc">$</span>DateTime</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fluxData<span class="sc">$</span>DateTime <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(fluxData<span class="sc">$</span>DateTime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data filtered based on R square values for CH4 flux</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>thresholdCH4 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>filtered_fluxData <span class="ot">&lt;-</span> fluxData <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FCH4_DRY_LIN_R2 <span class="sc">&gt;</span> thresholdCH4)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># data filtered based on R square values for CO2 flux</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>thresholdCO2 <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>filtered_fluxData <span class="ot">&lt;-</span> filtered_fluxData <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FCO2_DRY_LIN_R2 <span class="sc">&gt;</span> thresholdCO2)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># data filtered based on Soil Moisture</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>filtered_fluxData <span class="ot">&lt;-</span> filtered_fluxData <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SoilMoist_mean <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> SoilMoist_mean <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> SoilMoist_mean <span class="sc">!=</span> <span class="sc">-</span><span class="dv">9999</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtered_fluxData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  DateTime            LABEL   Temp FCH4_DRY_LIN FCH4_DRY_LIN_R2 FCO2_DRY_LIN
  &lt;dttm&gt;              &lt;chr&gt;  &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;        &lt;dbl&gt;
1 2023-07-28 11:50:22 P5C2-5  27.2       0.0168           0.246        0.582
2 2023-07-28 11:56:13 P5C4-5  27.7      -0.608            0.996        4.02 
3 2023-07-28 12:02:12 P5E2-5  27.5      -0.155            0.949        2.22 
4 2023-07-28 12:05:10 P1E3-5  27.6      -0.133            0.830        2.57 
5 2023-07-28 12:08:32 P5E4-5  27.8      -0.377            0.979        3.97 
6 2023-07-28 12:15:39 P1C1-5  27.6      -0.487            0.992        2.77 
# ℹ 4 more variables: FCO2_DRY_LIN_R2 &lt;dbl&gt;, COLLAR_HEIGHT &lt;dbl&gt;,
#   SoilMoist_mean &lt;dbl&gt;, DateTime_chr &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>filtered_fluxData <span class="ot">&lt;-</span> <span class="fu">filter</span>(filtered_fluxData, <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"wrong"</span>, LABEL))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change col names</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>filtered_fluxData<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">substr</span>(filtered_fluxData<span class="sc">$</span>LABEL, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>filtered_fluxData<span class="sc">$</span>collar <span class="ot">&lt;-</span> <span class="fu">substr</span>(filtered_fluxData<span class="sc">$</span>LABEL, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>filtered_fluxData<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">substr</span>(filtered_fluxData<span class="sc">$</span>LABEL, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>filtered_fluxData<span class="sc">$</span>wet_up_stage <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(filtered_fluxData<span class="sc">$</span>LABEL, <span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>filtered_fluxData<span class="sc">$</span>plot_treatment <span class="ot">&lt;-</span> <span class="fu">substr</span>(filtered_fluxData<span class="sc">$</span>LABEL, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(filtered_fluxData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [279 × 15] (S3: tbl_df/tbl/data.frame)
 $ DateTime       : POSIXct[1:279], format: "2023-07-28 11:50:22" "2023-07-28 11:56:13" ...
 $ LABEL          : chr [1:279] "P5C2-5" "P5C4-5" "P5E2-5" "P1E3-5" ...
 $ Temp           : num [1:279] 27.2 27.7 27.5 27.6 27.8 ...
 $ FCH4_DRY_LIN   : num [1:279] 0.0168 -0.608 -0.1551 -0.1335 -0.3771 ...
 $ FCH4_DRY_LIN_R2: num [1:279] 0.246 0.996 0.949 0.83 0.979 ...
 $ FCO2_DRY_LIN   : num [1:279] 0.582 4.022 2.222 2.574 3.97 ...
 $ FCO2_DRY_LIN_R2: num [1:279] 0.965 0.999 0.997 0.996 0.998 ...
 $ COLLAR_HEIGHT  : num [1:279] 0.38 0.47 0.75 0.27 1 0.87 1.27 0.95 0.8 0.55 ...
 $ SoilMoist_mean : num [1:279] 0.00773 0.2796 0.13142 0.25492 0.15988 ...
 $ DateTime_chr   : chr [1:279] "2023/07/28 11:50:22" "2023/07/28 11:56:13" "2023/07/28 12:02:12" "2023/07/28 12:05:10" ...
 $ plot           : chr [1:279] "P5" "P5" "P5" "P1" ...
 $ collar         : chr [1:279] "C2" "C4" "E2" "E3" ...
 $ treatment      : chr [1:279] "C" "C" "E" "E" ...
 $ wet_up_stage   : num [1:279] 5 5 5 5 5 5 5 5 5 5 ...
 $ plot_treatment : chr [1:279] "P5C" "P5C" "P5E" "P1E" ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtered_fluxData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 15
  DateTime            LABEL   Temp FCH4_DRY_LIN FCH4_DRY_LIN_R2 FCO2_DRY_LIN
  &lt;dttm&gt;              &lt;chr&gt;  &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;        &lt;dbl&gt;
1 2023-07-28 11:50:22 P5C2-5  27.2       0.0168           0.246        0.582
2 2023-07-28 11:56:13 P5C4-5  27.7      -0.608            0.996        4.02 
3 2023-07-28 12:02:12 P5E2-5  27.5      -0.155            0.949        2.22 
4 2023-07-28 12:05:10 P1E3-5  27.6      -0.133            0.830        2.57 
5 2023-07-28 12:08:32 P5E4-5  27.8      -0.377            0.979        3.97 
6 2023-07-28 12:15:39 P1C1-5  27.6      -0.487            0.992        2.77 
# ℹ 9 more variables: FCO2_DRY_LIN_R2 &lt;dbl&gt;, COLLAR_HEIGHT &lt;dbl&gt;,
#   SoilMoist_mean &lt;dbl&gt;, DateTime_chr &lt;chr&gt;, plot &lt;chr&gt;, collar &lt;chr&gt;,
#   treatment &lt;chr&gt;, wet_up_stage &lt;dbl&gt;, plot_treatment &lt;chr&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find how differences in moisture depending on the measuring site</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>filtered_fluxData <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">SoilMoisture =</span> <span class="fu">mean</span>(SoilMoist_mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  plot  SoilMoisture
  &lt;chr&gt;        &lt;dbl&gt;
1 P1           0.235
2 P5           0.310</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>filtered_fluxData <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot_treatment) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">SoilMoisture =</span> <span class="fu">mean</span>(SoilMoist_mean), <span class="at">sd_SM =</span> <span class="fu">sd</span>(SoilMoist_mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  plot_treatment SoilMoisture  sd_SM
  &lt;chr&gt;                 &lt;dbl&gt;  &lt;dbl&gt;
1 P1C                   0.257 0.0906
2 P1E                   0.212 0.0764
3 P5C                   0.358 0.118 
4 P5E                   0.267 0.125 </code></pre>
</div>
</div>
</section>
<section id="making-the-means" class="level2">
<h2 class="anchored" data-anchor-id="making-the-means">Making the means</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>summarytable_plot_treatment_measurement <span class="ot">&lt;-</span> filtered_fluxData <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot, treatment, wet_up_stage) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_CO2_flux =</span> <span class="fu">mean</span>(FCO2_DRY_LIN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_CH4_flux =</span> <span class="fu">mean</span>(FCH4_DRY_LIN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_CO2_flux =</span> <span class="fu">sd</span>(FCO2_DRY_LIN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_CH4_flux =</span> <span class="fu">sd</span>(FCH4_DRY_LIN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">stderr_CO2_flux =</span> <span class="fu">sd</span>(FCO2_DRY_LIN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">stderr_CH4_flux =</span> <span class="fu">sd</span>(FCH4_DRY_LIN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_soil_VWC =</span> <span class="fu">mean</span>(SoilMoist_mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_soil_VWC =</span> <span class="fu">sd</span>(SoilMoist_mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">date_time =</span> DateTime)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>summarytable_plot_treatment_measurement</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 279 × 12
# Groups:   plot, treatment, wet_up_stage [20]
   plot  treatment wet_up_stage mean_CO2_flux mean_CH4_flux sd_CO2_flux
   &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;
 1 P1    C                    1          4.57        -0.615        2.17
 2 P1    C                    1          4.57        -0.615        2.17
 3 P1    C                    1          4.57        -0.615        2.17
 4 P1    C                    1          4.57        -0.615        2.17
 5 P1    C                    1          4.57        -0.615        2.17
 6 P1    C                    1          4.57        -0.615        2.17
 7 P1    C                    1          4.57        -0.615        2.17
 8 P1    C                    1          4.57        -0.615        2.17
 9 P1    C                    1          4.57        -0.615        2.17
10 P1    C                    1          4.57        -0.615        2.17
# ℹ 269 more rows
# ℹ 6 more variables: sd_CH4_flux &lt;dbl&gt;, stderr_CO2_flux &lt;dbl&gt;,
#   stderr_CH4_flux &lt;dbl&gt;, mean_soil_VWC &lt;dbl&gt;, sd_soil_VWC &lt;dbl&gt;,
#   date_time &lt;dttm&gt;</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colors consistent with the incubation experiment colors</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>custom_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"P1"</span> <span class="ot">=</span> <span class="st">"#92c5de"</span>, <span class="st">"P5"</span> <span class="ot">=</span> <span class="st">"#0571b0"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>line_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"C"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"E"</span> <span class="ot">=</span> <span class="st">"dotted"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>summarytable_plot_treatment_measurement <span class="ot">&lt;-</span> summarytable_plot_treatment_measurement <span class="sc">%&gt;%</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot =</span> <span class="fu">as.factor</span>(plot),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">as.factor</span>(treatment),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">wet_up_stage =</span> <span class="fu">as.factor</span>(wet_up_stage)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>CO2_TURNED_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summarytable_plot_treatment_measurement, <span class="fu">aes</span>(<span class="at">x =</span> wet_up_stage, <span class="at">y =</span> mean_CO2_flux, <span class="at">color =</span> plot, <span class="at">linetype =</span> treatment, <span class="at">group =</span> <span class="fu">interaction</span>(plot, treatment))) <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_CO2_flux <span class="sc">-</span> stderr_CO2_flux, <span class="at">ymax =</span> mean_CO2_flux <span class="sc">+</span> stderr_CO2_flux), <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> custom_colors, <span class="at">name =</span> <span class="st">"Plot"</span>) <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> line_types, <span class="at">name =</span> <span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0 min"</span>, <span class="st">"2 min"</span>, <span class="st">"30 min"</span>, <span class="st">"8 hr"</span>, <span class="st">"24 hr"</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wet up stage"</span>, <span class="at">y =</span> <span class="st">"Mean CO₂ Flux (µmol m⁻² s⁻¹)"</span>, <span class="at">title =</span> <span class="st">"Mean CO₂ Flux Per Wet Up Stage based on treatment group"</span>) <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)  <span class="co"># Tilt labels to the side</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>CO2_TURNED_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FieldGAS_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   filename = "FIELD_CO2_ActualData_plot.png",</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot = CO2_TURNED_plot,</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   path = "~/Desktop/2024-2025/Spring 2025/Honors_Spring/Code/cso066code_BecerraSantillanHonors/TRACEincubation-Figures/",</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   width = 8,    </span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   height = 6,  </span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   dpi = 300    </span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="graph-just-for-data-exploration" class="level3">
<h3 class="anchored" data-anchor-id="graph-just-for-data-exploration">Graph just for data exploration</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>time_map <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="dv">30</span>, <span class="st">"4"</span> <span class="ot">=</span> <span class="dv">480</span>, <span class="st">"5"</span> <span class="ot">=</span> <span class="dv">1440</span>) </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># making new means</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>summarytable_plot_treatment_measurement <span class="ot">&lt;-</span> summarytable_plot_treatment_measurement <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot =</span> <span class="fu">factor</span>(plot),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">factor</span>(treatment),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">wet_up_stage =</span> <span class="fu">factor</span>(wet_up_stage),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_min =</span> <span class="fu">as.numeric</span>(<span class="fu">recode</span>(wet_up_stage, <span class="sc">!!!</span>time_map))  <span class="co"># new x-axis</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>CO2_TURNED_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summarytable_plot_treatment_measurement, <span class="fu">aes</span>(<span class="at">x =</span> time_min, <span class="at">y =</span> mean_CO2_flux,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">color =</span> plot, <span class="at">linetype =</span> treatment)) <span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_CO2_flux <span class="sc">-</span> stderr_CO2_flux,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_CO2_flux <span class="sc">+</span> stderr_CO2_flux), <span class="at">width =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> custom_colors, <span class="at">name =</span> <span class="st">"Plot"</span>) <span class="sc">+</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> line_types, <span class="at">name =</span> <span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Time Since Wet-up (minutes)"</span>,</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">30</span>, <span class="dv">480</span>, <span class="dv">1440</span>),</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0 min"</span>, <span class="st">"2 min"</span>, <span class="st">"30 min"</span>, <span class="st">"8 hr"</span>, <span class="st">"24 hr"</span>)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean CO₂ Flux (µmol m⁻² s⁻¹)"</span>,</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean CO₂ Flux over Time Since Wet-up"</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>CO2_TURNED_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FieldGAS_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="co2-two-way-anova" class="level2">
<h2 class="anchored" data-anchor-id="co2-two-way-anova">CO2 Two way ANOVA</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(mean_CO2_flux <span class="sc">~</span> plot <span class="sc">+</span> treatment <span class="sc">+</span> plot <span class="sc">*</span> wet_up_stage <span class="sc">+</span> treatment <span class="sc">*</span> wet_up_stage, <span class="at">data =</span> summarytable_plot_treatment_measurement)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                        Df Sum Sq Mean Sq F value Pr(&gt;F)    
plot                     1  430.2   430.2 4739.01 &lt;2e-16 ***
treatment                1    8.3     8.3   91.81 &lt;2e-16 ***
wet_up_stage             4   96.4    24.1  265.54 &lt;2e-16 ***
plot:wet_up_stage        4   13.6     3.4   37.55 &lt;2e-16 ***
treatment:wet_up_stage   4   70.2    17.6  193.34 &lt;2e-16 ***
Residuals              264   24.0     0.1                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals normality</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(anova_result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(anova_result)
W = 0.9576, p-value = 2.899e-07</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hoc test (Tukey's HSD)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = mean_CO2_flux ~ plot + treatment + plot * wet_up_stage + treatment * wet_up_stage, data = summarytable_plot_treatment_measurement)

$plot
           diff      lwr       upr p adj
P5-P1 -2.510727 -2.58254 -2.438915     0

$treatment
         diff       lwr       upr p adj
E-C 0.3455608 0.2745239 0.4165976     0

$wet_up_stage
           diff         lwr        upr     p adj
2-1 -1.35824537 -1.50599418 -1.2104965 0.0000000
3-1 -0.51562388 -0.65914592 -0.3721018 0.0000000
4-1  0.21745220  0.05686907  0.3780353 0.0022529
5-1  0.17340186  0.01169559  0.3351081 0.0287147
3-2  0.84262149  0.69434947  0.9908935 0.0000000
4-2  1.57569756  1.41085536  1.7405398 0.0000000
5-2  1.53164723  1.36571070  1.6975838 0.0000000
4-3  0.73307608  0.57201144  0.8941407 0.0000000
5-3  0.68902574  0.52684129  0.8512102 0.0000000
5-4 -0.04405034 -0.22151064  0.1334100 0.9602613

$`plot:wet_up_stage`
                 diff         lwr         upr     p adj
P5:1-P1:1 -2.53912785 -2.77727332 -2.30098238 0.0000000
P1:2-P1:1 -1.62794856 -1.85015842 -1.40573870 0.0000000
P5:2-P1:1 -3.47727481 -3.73003919 -3.22451043 0.0000000
P1:3-P1:1 -0.51717664 -0.73781950 -0.29653378 0.0000000
P5:3-P1:1 -3.05138202 -3.28712534 -2.81563870 0.0000000
P1:4-P1:1  0.59080523  0.33804085  0.84356961 0.0000000
P5:4-P1:1 -2.72705370 -2.98727924 -2.46682816 0.0000000
P1:5-P1:1  0.26178463  0.01546222  0.50810704 0.0271918
P5:5-P1:1 -2.48843274 -2.76239145 -2.21447402 0.0000000
P1:2-P5:1  0.91117929  0.66892249  1.15343608 0.0000000
P5:2-P5:1 -0.93814696 -1.20870373 -0.66759019 0.0000000
P1:3-P5:1  2.02195122  1.78113094  2.26277149 0.0000000
P5:3-P5:1 -0.51225417 -0.76698157 -0.25752677 0.0000000
P1:4-P5:1  3.12993308  2.85937631  3.40048985 0.0000000
P5:4-P5:1 -0.18792585 -0.46546587  0.08961418 0.4866039
P1:5-P5:1  2.80091248  2.53636407  3.06546090 0.0000000
P5:5-P5:1  0.05069511 -0.23976058  0.34115081 0.9999247
P5:2-P1:2 -1.84932625 -2.10596787 -1.59268463 0.0000000
P1:3-P1:2  1.11077193  0.88569781  1.33584605 0.0000000
P5:3-P1:2 -1.42343346 -1.66332927 -1.18353764 0.0000000
P1:4-P1:2  2.21875379  1.96211217  2.47539541 0.0000000
P5:4-P1:2 -1.09910514 -1.36309836 -0.83511191 0.0000000
P1:5-P1:2  1.88973319  1.63943374  2.14003265 0.0000000
P5:5-P1:2 -0.86048417 -1.13802420 -0.58294415 0.0000000
P1:3-P5:2  2.96009818  2.70481212  3.21538423 0.0000000
P5:3-P5:2  0.42589279  0.15744799  0.69433760 0.0000339
P1:4-P5:2  4.06808004  3.78457073  4.35158935 0.0000000
P5:4-P5:2  0.75022111  0.46004008  1.04040214 0.0000000
P1:5-P5:2  3.73905944  3.46127818  4.01684070 0.0000000
P5:5-P5:2  0.98884208  0.68628452  1.29139963 0.0000000
P5:3-P1:3 -2.53420538 -2.77265046 -2.29576031 0.0000000
P1:4-P1:3  1.10798186  0.85269581  1.36326792 0.0000000
P5:4-P1:3 -2.20987706 -2.47255266 -1.94720146 0.0000000
P1:5-P1:3  0.77896127  0.53005191  1.02787062 0.0000000
P5:5-P1:3 -1.97125610 -2.24754312 -1.69496909 0.0000000
P1:4-P5:3  3.64218725  3.37374244  3.91063205 0.0000000
P5:4-P5:3  0.32432832  0.04884672  0.59980992 0.0079460
P1:5-P5:3  3.31316665  3.05077856  3.57555474 0.0000000
P5:5-P5:3  0.56294928  0.27445984  0.85143872 0.0000001
P5:4-P1:4 -3.31785893 -3.60803996 -3.02767789 0.0000000
P1:5-P1:4 -0.32902060 -0.60680186 -0.05123934 0.0073238
P5:5-P1:4 -3.07923796 -3.38179552 -2.77668041 0.0000000
P1:5-P5:4  2.98883833  2.70425103  3.27342563 0.0000000
P5:5-P5:4  0.23862096 -0.07019707  0.54743899 0.2921102
P5:5-P1:5 -2.75021737 -3.04741423 -2.45302051 0.0000000

$`treatment:wet_up_stage`
                diff         lwr         upr     p adj
E:1-C:1  0.971485478  0.73591463  1.20705633 0.0000000
C:2-C:1 -0.164704173 -0.40517833  0.07576999 0.4693414
E:2-C:1 -1.763835705 -2.01950946 -1.50816195 0.0000000
C:3-C:1 -0.161197849 -0.40348517  0.08108947 0.5129466
E:3-C:1  0.148807638 -0.08994744  0.38756272 0.6076458
C:4-C:1  0.250194893 -0.01782189  0.51821168 0.0902750
E:4-C:1  1.201767882  0.93375110  1.46978467 0.0000000
C:5-C:1  0.171967824 -0.10377581  0.44771145 0.6067806
E:5-C:1  1.148964219  0.88437730  1.41355113 0.0000000
C:2-E:1 -1.136189652 -1.36789314 -0.90448616 0.0000000
E:2-E:1 -2.735321183 -2.98276361 -2.48787876 0.0000000
C:3-E:1 -1.132683327 -1.36626807 -0.89909859 0.0000000
E:3-E:1 -0.822677840 -1.05259668 -0.59275900 0.0000000
C:4-E:1 -0.721290585 -0.98146684 -0.46111433 0.0000000
E:4-E:1  0.230282403 -0.02989385  0.49045865 0.1337016
C:5-E:1 -0.799517654 -1.06764679 -0.53138852 0.0000000
E:5-E:1  0.177478740 -0.07916288  0.43412036 0.4548005
E:2-C:2 -1.599131532 -1.85124649 -1.34701658 0.0000000
C:3-C:2  0.003506324 -0.23502255  0.24203520 1.0000000
E:3-C:2  0.313511812  0.07857167  0.54845195 0.0011728
C:4-C:2  0.414899067  0.15027504  0.67952310 0.0000448
E:4-C:2  1.366472055  1.10184802  1.63109609 0.0000000
C:5-C:2  0.336671997  0.06422488  0.60911911 0.0040159
E:5-C:2  1.313668392  1.05251879  1.57481800 0.0000000
C:3-E:2  1.602637856  1.34879288  1.85648284 0.0000000
E:3-E:2  1.912643343  1.66216756  2.16311912 0.0000000
C:4-E:2  2.014030598  1.73552184  2.29253935 0.0000000
E:4-E:2  2.965603587  2.68709483  3.24411234 0.0000000
C:5-E:2  1.935803529  1.64985130  2.22175576 0.0000000
E:5-E:2  2.912799923  2.63759025  3.18800960 0.0000000
E:3-C:3  0.310005487  0.07320981  0.54680116 0.0016217
C:4-C:3  0.411392742  0.14511995  0.67766554 0.0000630
E:4-C:3  1.362965731  1.09669294  1.62923853 0.0000000
C:5-C:3  0.333165673  0.05911686  0.60721449 0.0050941
E:5-C:3  1.310162068  1.04734190  1.57298223 0.0000000
C:4-E:3  0.101387255 -0.16167556  0.36445007 0.9669644
E:4-E:3  1.052960243  0.78989743  1.31602306 0.0000000
C:5-E:3  0.023160186 -0.24777080  0.29409117 0.9999998
E:5-E:3  1.000156580  0.74058909  1.25972407 0.0000000
E:4-C:4  0.951572988  0.66169189  1.24145409 0.0000000
C:5-C:4 -0.078227069 -0.37526681  0.21881267 0.9978590
E:5-C:4  0.898769325  0.61205642  1.18548223 0.0000000
C:5-E:4 -1.029800058 -1.32683980 -0.73276032 0.0000000
E:5-E:4 -0.052803663 -0.33951657  0.23390924 0.9998817
E:5-C:5  0.976996395  0.68304768  1.27094510 0.0000000</code></pre>
</div>
</div>
</section>
<section id="co2" class="level1">
<h1>CO2</h1>
<section id="final-mixed-effects-model" class="level2">
<h2 class="anchored" data-anchor-id="final-mixed-effects-model">Final Mixed effects model</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>filtered_fluxData<span class="sc">$</span>wet_up_stage <span class="ot">&lt;-</span> <span class="fu">factor</span>(filtered_fluxData<span class="sc">$</span>wet_up_stage)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>filtered_fluxData<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(filtered_fluxData<span class="sc">$</span>DateTime)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>filtered_fluxData_no_PREWET<span class="ot">&lt;-</span> filtered_fluxData <span class="sc">%&gt;%</span> </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wet_up_stage <span class="sc">!=</span> <span class="st">"1"</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>model_fulldata_collar_CO2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(FCO2_DRY_LIN <span class="sc">~</span>  plot <span class="sc">*</span> treatment <span class="sc">*</span> wet_up_stage <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot<span class="sc">/</span>collar) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Date), </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> filtered_fluxData_no_PREWET)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fulldata_collar_CO2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: FCO2_DRY_LIN ~ plot * treatment * wet_up_stage + (1 | plot/collar) +  
    (1 | Date)
   Data: filtered_fluxData_no_PREWET

REML criterion at convergence: 502.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.0122 -0.3581  0.0509  0.5259  2.7934 

Random effects:
 Groups      Name        Variance Std.Dev.
 collar:plot (Intercept) 2.03009  1.425   
 Date        (Intercept) 0.07672  0.277   
 plot        (Intercept) 1.77210  1.331   
 Residual                0.45966  0.678   
Number of obs: 212, groups:  collar:plot, 16; Date, 8; plot, 2

Fixed effects:
                                Estimate Std. Error t value
(Intercept)                      4.39571    1.52291   2.886
plotP5                          -2.21410    2.14889  -1.030
treatmentE                      -2.10002    1.03304  -2.033
wet_up_stage3                   -0.27221    0.22049  -1.235
wet_up_stage4                    0.57954    0.25492   2.273
wet_up_stage5                    0.42869    0.32172   1.332
plotP5:treatmentE                0.82023    1.47328   0.557
plotP5:wet_up_stage3             0.30257    0.34282   0.883
plotP5:wet_up_stage4             0.04549    0.37955   0.120
plotP5:wet_up_stage5            -0.35495    0.39389  -0.901
treatmentE:wet_up_stage3         3.10679    0.32016   9.704
treatmentE:wet_up_stage4         4.06406    0.36430  11.156
treatmentE:wet_up_stage5         3.37453    0.35592   9.481
plotP5:treatmentE:wet_up_stage3 -1.94591    0.50634  -3.843
plotP5:treatmentE:wet_up_stage4 -2.97585    0.55878  -5.326
plotP5:treatmentE:wet_up_stage5 -1.39296    0.56514  -2.465</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>optimizer (nloptwrap) convergence code: 0 (OK)
unable to evaluate scaled gradient
Model failed to converge: degenerate  Hessian with 1 negative eigenvalues</code></pre>
</div>
</div>
</section>
</section>
<section id="interaction-terms-analysis" class="level1">
<h1>Interaction terms analysis</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>emm_CO2 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_fulldata_collar_CO2, <span class="sc">~</span> treatment <span class="sc">*</span> wet_up_stage <span class="sc">*</span> plot)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(emm_CO2, <span class="at">interaction =</span> <span class="cn">TRUE</span>, <span class="at">adjust =</span> <span class="st">"sidak"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> treatment_eff wet_up_stage_eff plot_eff  estimate     SE  df t.ratio p.value
 C effect      2 effect         P1 effect   0.3947 0.0824 179   4.791  0.0001
 E effect      2 effect         P1 effect  -0.3947 0.0824 179  -4.791  0.0001
 C effect      3 effect         P1 effect  -0.0918 0.0772 178  -1.190  0.9864
 E effect      3 effect         P1 effect   0.0918 0.0772 178   1.190  0.9864
 C effect      4 effect         P1 effect  -0.3493 0.0878 179  -3.976  0.0016
 E effect      4 effect         P1 effect   0.3493 0.0878 179   3.976  0.0016
 C effect      5 effect         P1 effect   0.0464 0.0893 179   0.520  1.0000
 E effect      5 effect         P1 effect  -0.0464 0.0893 179  -0.520  1.0000
 C effect      2 effect         P5 effect  -0.3947 0.0824 179  -4.791  0.0001
 E effect      2 effect         P5 effect   0.3947 0.0824 179   4.791  0.0001
 C effect      3 effect         P5 effect   0.0918 0.0772 178   1.190  0.9864
 E effect      3 effect         P5 effect  -0.0918 0.0772 178  -1.190  0.9864
 C effect      4 effect         P5 effect   0.3493 0.0878 179   3.976  0.0016
 E effect      4 effect         P5 effect  -0.3493 0.0878 179  -3.976  0.0016
 C effect      5 effect         P5 effect  -0.0464 0.0893 179  -0.520  1.0000
 E effect      5 effect         P5 effect   0.0464 0.0893 179   0.520  1.0000

Degrees-of-freedom method: kenward-roger 
P value adjustment: sidak method for 16 tests </code></pre>
</div>
</div>
<section id="is-p1-mean-co2-higher-than-p5" class="level3">
<h3 class="anchored" data-anchor-id="is-p1-mean-co2-higher-than-p5">Is P1 mean CO2 higher than P5?</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(model_fulldata_collar_CO2, <span class="sc">~</span> treatment <span class="sc">*</span> wet_up_stage <span class="sc">*</span> plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> treatment wet_up_stage plot emmean   SE  df lower.CL upper.CL
 C         2            P1    4.396 1.52 241   1.3958     7.40
 E         2            P1    2.296 1.52 242  -0.7065     5.30
 C         3            P1    4.123 1.52 241   1.1236     7.12
 E         3            P1    5.130 1.52 241   2.1294     8.13
 C         4            P1    4.975 1.53 244   1.9648     7.99
 E         4            P1    6.939 1.53 245   3.9265     9.95
 C         5            P1    4.824 1.53 245   1.8091     7.84
 E         5            P1    6.099 1.53 244   3.0853     9.11
 C         2            P5    2.182 1.53 243  -0.8247     5.19
 E         2            P5    0.902 1.53 248  -2.1182     3.92
 C         3            P5    2.212 1.53 244  -0.7963     5.22
 E         3            P5    2.093 1.52 242  -0.9105     5.10
 C         4            P5    2.807 1.53 246  -0.2103     5.82
 E         4            P5    2.615 1.53 245  -0.3978     5.63
 C         5            P5    2.255 1.54 249  -0.7727     5.28
 E         5            P5    2.957 1.53 247  -0.0638     5.98

Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(emm_CO2, <span class="at">interaction =</span> <span class="cn">TRUE</span>, <span class="at">adjust =</span> <span class="st">"sidak"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> treatment_eff wet_up_stage_eff plot_eff  estimate     SE  df t.ratio p.value
 C effect      2 effect         P1 effect   0.3947 0.0824 179   4.791  0.0001
 E effect      2 effect         P1 effect  -0.3947 0.0824 179  -4.791  0.0001
 C effect      3 effect         P1 effect  -0.0918 0.0772 178  -1.190  0.9864
 E effect      3 effect         P1 effect   0.0918 0.0772 178   1.190  0.9864
 C effect      4 effect         P1 effect  -0.3493 0.0878 179  -3.976  0.0016
 E effect      4 effect         P1 effect   0.3493 0.0878 179   3.976  0.0016
 C effect      5 effect         P1 effect   0.0464 0.0893 179   0.520  1.0000
 E effect      5 effect         P1 effect  -0.0464 0.0893 179  -0.520  1.0000
 C effect      2 effect         P5 effect  -0.3947 0.0824 179  -4.791  0.0001
 E effect      2 effect         P5 effect   0.3947 0.0824 179   4.791  0.0001
 C effect      3 effect         P5 effect   0.0918 0.0772 178   1.190  0.9864
 E effect      3 effect         P5 effect  -0.0918 0.0772 178  -1.190  0.9864
 C effect      4 effect         P5 effect   0.3493 0.0878 179   3.976  0.0016
 E effect      4 effect         P5 effect  -0.3493 0.0878 179  -3.976  0.0016
 C effect      5 effect         P5 effect  -0.0464 0.0893 179  -0.520  1.0000
 E effect      5 effect         P5 effect   0.0464 0.0893 179   0.520  1.0000

Degrees-of-freedom method: kenward-roger 
P value adjustment: sidak method for 16 tests </code></pre>
</div>
</div>
</section>
</section>
<section id="ch4" class="level1">
<h1>CH4</h1>
</section>
<section id="graph" class="level1">
<h1>Graph</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>CH4_TURNED_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summarytable_plot_treatment_measurement, <span class="fu">aes</span>(<span class="at">x =</span> wet_up_stage, <span class="at">y =</span> mean_CH4_flux, <span class="at">color =</span> plot, <span class="at">linetype =</span> treatment, <span class="at">group =</span> <span class="fu">interaction</span>(plot, treatment))) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_CH4_flux <span class="sc">-</span> stderr_CH4_flux, <span class="at">ymax =</span> mean_CH4_flux <span class="sc">+</span> stderr_CH4_flux), <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> custom_colors, <span class="at">name =</span> <span class="st">"Plot"</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> line_types, <span class="at">name =</span> <span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0 min"</span>, <span class="st">"2 min"</span>, <span class="st">"30 min"</span>, <span class="st">"8 hr"</span>, <span class="st">"24 hr"</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wet up stage"</span>, <span class="at">y =</span> <span class="st">"Mean CH₄ Flux (µmol m⁻² s⁻¹)"</span>, <span class="at">title =</span> <span class="st">"Mean CO₄ Flux Per Wet Up Stage based on treatment group"</span>) <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)  <span class="co"># Tilt labels to the side</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>CH4_TURNED_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FieldGAS_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   filename = "FIELD_CH4_ActualData_plot.png",</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot = CH4_TURNED_plot,</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   path = "~/Desktop/2024-2025/Spring 2025/Honors_Spring/Code/cso066code_BecerraSantillanHonors/TRACEincubation-Figures/",</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   width = 8,    </span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   height = 6,  </span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   dpi = 300     </span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="final-mixed-effects-model-1" class="level1">
<h1>Final Mixed effects model</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>model_fulldata_collar_CH4 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(FCH4_DRY_LIN <span class="sc">~</span> plot <span class="sc">*</span> treatment <span class="sc">*</span> wet_up_stage <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot<span class="sc">/</span>collar) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Date),</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> filtered_fluxData_no_PREWET)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_fulldata_collar_CH4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: FCH4_DRY_LIN ~ plot * treatment * wet_up_stage + (1 | plot/collar) +  
    (1 | Date)
   Data: filtered_fluxData_no_PREWET

REML criterion at convergence: 145

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.9658 -0.4015 -0.0141  0.2644  9.0333 

Random effects:
 Groups      Name        Variance Std.Dev.
 collar:plot (Intercept) 0.019449 0.13946 
 Date        (Intercept) 0.009791 0.09895 
 plot        (Intercept) 0.012949 0.11379 
 Residual                0.088196 0.29698 
Number of obs: 212, groups:  collar:plot, 16; Date, 8; plot, 2

Fixed effects:
                                 Estimate Std. Error t value
(Intercept)                     -0.586786   0.156286  -3.755
plotP5                           0.375027   0.216332   1.734
treatmentE                       0.379674   0.140311   2.706
wet_up_stage3                    0.017633   0.096541   0.183
wet_up_stage4                   -0.061217   0.111439  -0.549
wet_up_stage5                   -0.017900   0.131254  -0.136
plotP5:treatmentE               -0.218823   0.214835  -1.019
plotP5:wet_up_stage3            -0.019099   0.150009  -0.127
plotP5:wet_up_stage4             0.072468   0.165940   0.437
plotP5:wet_up_stage5             0.048868   0.172354   0.284
treatmentE:wet_up_stage3        -0.144491   0.140010  -1.032
treatmentE:wet_up_stage4        -0.045238   0.159386  -0.284
treatmentE:wet_up_stage5        -0.302223   0.155656  -1.942
plotP5:treatmentE:wet_up_stage3  0.003236   0.221066   0.015
plotP5:treatmentE:wet_up_stage4 -0.090884   0.243866  -0.373
plotP5:treatmentE:wet_up_stage5  0.071238   0.246925   0.289</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>optimizer (nloptwrap) convergence code: 0 (OK)
unable to evaluate scaled gradient
Model failed to converge: degenerate  Hessian with 1 negative eigenvalues</code></pre>
</div>
</div>
</section>
<section id="interaction-terms-analysis-1" class="level1">
<h1>Interaction terms analysis</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>emm_CH4 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_fulldata_collar_CH4, <span class="sc">~</span> treatment <span class="sc">*</span> wet_up_stage <span class="sc">*</span> plot)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(emm_CH4, <span class="at">interaction =</span> <span class="cn">TRUE</span>, <span class="at">adjust =</span> <span class="st">"sidak"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> treatment_eff wet_up_stage_eff plot_eff  estimate     SE  df t.ratio p.value
 C effect      2 effect         P1 effect  0.00103 0.0360 182   0.028  1.0000
 E effect      2 effect         P1 effect -0.00103 0.0360 182  -0.028  1.0000
 C effect      3 effect         P1 effect  0.00183 0.0338 179   0.054  1.0000
 E effect      3 effect         P1 effect -0.00183 0.0338 179  -0.054  1.0000
 C effect      4 effect         P1 effect -0.02170 0.0384 180  -0.565  1.0000
 E effect      4 effect         P1 effect  0.02170 0.0384 180   0.565  1.0000
 C effect      5 effect         P1 effect  0.01884 0.0391 180   0.482  1.0000
 E effect      5 effect         P1 effect -0.01884 0.0391 180  -0.482  1.0000
 C effect      2 effect         P5 effect -0.00103 0.0360 182  -0.028  1.0000
 E effect      2 effect         P5 effect  0.00103 0.0360 182   0.028  1.0000
 C effect      3 effect         P5 effect -0.00183 0.0338 179  -0.054  1.0000
 E effect      3 effect         P5 effect  0.00183 0.0338 179   0.054  1.0000
 C effect      4 effect         P5 effect  0.02170 0.0384 180   0.565  1.0000
 E effect      4 effect         P5 effect -0.02170 0.0384 180  -0.565  1.0000
 C effect      5 effect         P5 effect -0.01884 0.0391 180  -0.482  1.0000
 E effect      5 effect         P5 effect  0.01884 0.0391 180   0.482  1.0000

Degrees-of-freedom method: kenward-roger 
P value adjustment: sidak method for 16 tests </code></pre>
</div>
</div>
</section>
<section id="change-in-co2-and-ch4-over-time-making-variables" class="level1">
<h1>Change in CO2 and CH4 over time: Making variables</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>baseline_values <span class="ot">&lt;-</span> filtered_fluxData <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wet_up_stage <span class="sc">==</span> <span class="st">"1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot, treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">baselineCO2 =</span> <span class="fu">mean</span>(FCO2_DRY_LIN),</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">baselineCH4 =</span> <span class="fu">mean</span>(FCH4_DRY_LIN),</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_baselineCO2 =</span> <span class="fu">sd</span>(FCO2_DRY_LIN) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_baselineCH4 =</span> <span class="fu">sd</span>(FCH4_DRY_LIN) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># do the subtraction</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>filtered_fluxData_diff <span class="ot">&lt;-</span> <span class="fu">left_join</span>(filtered_fluxData, baseline_values, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"plot"</span>, <span class="st">"treatment"</span>))</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>filtered_fluxData_diff <span class="ot">&lt;-</span> filtered_fluxData_diff <span class="sc">%&gt;%</span> </span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">difference_CH4 =</span> FCH4_DRY_LIN <span class="sc">-</span> baselineCH4,</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">difference_CO2 =</span> FCO2_DRY_LIN <span class="sc">-</span> baselineCO2)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Making the means of differences</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>meanDiff_CO2 <span class="ot">&lt;-</span> filtered_fluxData_diff  <span class="sc">%&gt;%</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot, treatment, wet_up_stage) <span class="sc">%&gt;%</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_CO2_fluxDiff =</span> <span class="fu">mean</span>(difference_CO2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">stderr_CO2_fluxDiff =</span> <span class="fu">sd</span>(difference_CO2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()))</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>meanDiff_CH4 <span class="ot">&lt;-</span> filtered_fluxData_diff  <span class="sc">%&gt;%</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot, treatment, wet_up_stage) <span class="sc">%&gt;%</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_CH4_fluxDiff =</span> <span class="fu">mean</span>(difference_CH4, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">stderr_CH4_fluxDiff =</span> <span class="fu">sd</span>(difference_CH4, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()))</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>meanDiff_CH4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 5
# Groups:   plot, treatment [4]
   plot  treatment wet_up_stage mean_CH4_fluxDiff stderr_CH4_fluxDiff
   &lt;chr&gt; &lt;chr&gt;     &lt;fct&gt;                    &lt;dbl&gt;               &lt;dbl&gt;
 1 P1    C         1                    -7.01e-17              0.0674
 2 P1    C         2                     3.27e- 2              0.0652
 3 P1    C         3                     3.90e- 2              0.0676
 4 P1    C         4                     3.41e- 2              0.0954
 5 P1    C         5                     1.06e- 2              0.0638
 6 P1    E         1                     0                     0.0671
 7 P1    E         2                     3.74e- 1              0.0422
 8 P1    E         3                     2.49e- 1              0.0346
 9 P1    E         4                     3.55e- 1              0.288 
10 P1    E         5                     6.70e- 2              0.0419
11 P5    C         1                     1.39e-17              0.0634
12 P5    C         2                     5.23e- 2              0.0683
13 P5    C         3                     1.96e- 2              0.0593
14 P5    C         4                     1.04e- 1              0.0945
15 P5    C         5                     4.65e- 2              0.0948
16 P5    E         1                    -4.34e-18              0.0573
17 P5    E         2                     1.76e- 1              0.0286
18 P5    E         3                     1.27e- 1              0.0219
19 P5    E         4                     1.79e- 1              0.175 
20 P5    E         5                     2.08e- 2              0.0378</code></pre>
</div>
</div>
</section>
<section id="change-in-co2-and-ch4-over-time-graphing" class="level1">
<h1>Change in CO2 and CH4 over time: Graphing</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>Mean_Difference_CH4Graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(meanDiff_CH4, <span class="fu">aes</span>(<span class="at">x =</span> wet_up_stage, <span class="at">y =</span> mean_CH4_fluxDiff, <span class="at">color =</span> plot, <span class="at">linetype =</span> treatment, <span class="at">group =</span> <span class="fu">interaction</span>(plot, treatment))) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_CH4_fluxDiff <span class="sc">-</span> stderr_CH4_fluxDiff, </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_CH4_fluxDiff <span class="sc">+</span> stderr_CH4_fluxDiff),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> custom_colors, <span class="at">name =</span> <span class="st">"Plot"</span>) <span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> line_types, <span class="at">name =</span> <span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0 min"</span>, <span class="st">"2 min"</span>, <span class="st">"30 min"</span>, <span class="st">"8 hr"</span>, <span class="st">"24 hr"</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wet up stage"</span>, <span class="at">y =</span> <span class="st">"Mean CH₄ Flux (µmol m⁻² s⁻¹)"</span>, <span class="at">title =</span> <span class="st">"Mean CH₄ Flux Per Wet Up Stage based on treatment group"</span>) <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)  </span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>Mean_Difference_CH4Graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FieldGAS_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   filename = "Mean_Difference_CH4Graph.png",</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot = Mean_Difference_CH4Graph,</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   path = "~/Desktop/2024-2025/Spring 2025/Honors_Spring/Code/cso066code_BecerraSantillanHonors/TRACEincubation-Figures",</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   width = 8,    </span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   height = 6,  </span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   dpi = 300    </span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>Mean_Difference_CO2Graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(meanDiff_CO2, <span class="fu">aes</span>(<span class="at">x =</span> wet_up_stage, <span class="at">y =</span> mean_CO2_fluxDiff, <span class="at">color =</span> plot, <span class="at">linetype =</span> treatment, <span class="at">group =</span> <span class="fu">interaction</span>(plot, treatment))) <span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_CO2_fluxDiff <span class="sc">-</span> stderr_CO2_fluxDiff, </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_CO2_fluxDiff <span class="sc">+</span> stderr_CO2_fluxDiff),</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> custom_colors, <span class="at">name =</span> <span class="st">"Plot"</span>) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> line_types, <span class="at">name =</span> <span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0 min"</span>, <span class="st">"2 min"</span>, <span class="st">"30 min"</span>, <span class="st">"8 hr"</span>, <span class="st">"24 hr"</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wet up stage"</span>, <span class="at">y =</span> <span class="st">"Mean CO₂ Flux (µmol m⁻² s⁻¹)"</span>, <span class="at">title =</span> <span class="st">"Mean CO₂ Flux Per Wet Up Stage based on treatment group"</span>) <span class="sc">+</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)  </span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>Mean_Difference_CO2Graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FieldGAS_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="both-plots-together" class="level1">
<h1>both plots together</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>FIELD_Mean_differences <span class="ot">&lt;-</span> Mean_Difference_CO2Graph<span class="sc">/</span>Mean_Difference_CH4Graph</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>FIELD_Mean_differences</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FieldGAS_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   filename = "FIELD_Mean_differences.png",</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot = FIELD_Mean_differences,</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   path = "~/Desktop/2024-2025/Spring 2025/Honors_Spring/Code/cso066code_BecerraSantillanHonors/TRACEincubation-Figures",</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   width = 10,    </span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   height = 8,   </span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   dpi = 300    </span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="timeseries-per-date" class="level1">
<h1>Timeseries per date</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>Field_WETUP_C02_timeseries <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summarytable_plot_treatment_measurement, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> date_time, <span class="at">y =</span> mean_CO2_flux, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> <span class="fu">interaction</span>(plot, treatment),</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> plot,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> treatment)) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_CO2_flux <span class="sc">-</span> stderr_CO2_flux, </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_CO2_flux <span class="sc">+</span> stderr_CO2_flux,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> plot,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">linetype =</span> treatment), <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> custom_colors, <span class="at">name =</span> <span class="st">"Plot"</span>) <span class="sc">+</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> line_types, <span class="at">name =</span> <span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"CO₂ Flux Over Time by Treatment"</span>,</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>, </span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean CO₂ Flux ± SE"</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)  </span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>Field_WETUP_C02_timeseries</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FieldGAS_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>